
# 研发流程 #

 *如果引用此文请提供原文出处。*

前面四篇文章以[分支流程](https://github.com/longtian2/cc3/blob/master/buildTeam/%E5%88%86%E6%94%AF%E6%B5%81%E7%A8%8B.md "分支流程")、[Commit 日志规范](https://github.com/longtian2/cc3/blob/master/buildTeam/Commit%20%E6%97%A5%E5%BF%97%E8%A7%84%E8%8C%83.md "Commit 日志规范")、[代码规范](https://github.com/longtian2/cc3/blob/master/buildTeam/%E4%BB%A3%E7%A0%81%E8%A7%84%E8%8C%83.md "代码规范")、[数据库规范](https://github.com/longtian2/cc3/blob/master/buildTeam/%E6%95%B0%E6%8D%AE%E5%BA%93%E8%A7%84%E8%8C%83.md "数据库规范")来约束开发同学提高代码质量，进而提高项目的质量，只有严格遵守以上规范才能有效保障项目的易维护和易扩展性。有些团队也许已经做到以上几点，但是项目“*整体质量*”未有提升，项目迭代推进缓慢，开发阶段、测试阶段、发布阶段问题层出不穷，导致项目延期，在单位时间内项目只有质而量未有提升。诚然，作为项目负责人在保障代码质量的前提下，还需要有高效的产出，换而言之--**就是要保质保量**。

无论您是测试还是开发同学，也许您曾经或正处在这样的研发环境中：

**开发阶段**：代码都快撸完了，才发现因为这样那样的原因，需求难以实现或者无法实现。譬如，依赖其他业务方接口未提供或者需求未同步，业务逻辑比预想的情况复杂，业务数据盘根错节。

**测试阶段**：提测的质量不高，严重bug太多，流程测试不通过，阻塞测试进度；测试环境不稳定，有开发修复bug引出新bug的问题，尤其依赖第三方服务不稳定会引起连锁反应，将会严重阻塞测试进度。

**发布阶段**：在预发布时，发现预付环境与线上环境运行不同代码所引起的兼容问题，如缓存被覆盖，MQ消息被线上环境消费，接口不兼容等问题。

这里列举的是一些比较常见的问题，而遇到这些问题将会花很长的时机去梳理、排查，甚至延误发布日期，迭代不能按时上线是管理者最不想看到的，因此我们要尽量去规避可以预见的问题，我们该如何做勒？

古语云：预则立，不预则废。要做到未雨绸缪，则需要确立明确的研发流程来约束，明确各职能的职责。这里还是推荐之前在阿里所采用的研发流程，该流程是跟[分支流程](https://github.com/longtian2/cc3/blob/master/buildTeam/%E5%88%86%E6%94%AF%E6%B5%81%E7%A8%8B.md "分支流程")一节相呼应的。

![研发流程](https://github.com/longtian2/cc3/blob/master/images/dev_bpm.png)

**需求调研**：产品在收到业务系统运营人员需求后，须斟酌需求的合理性，是否超出业务边界，是否契合系统规划的方向，跟开发同学确定技术可行性，确定需求优先级，协调其他业务方支撑事宜等。

**需求评审**：产品需跟项目负责人确定本次迭代功能点，项目负责人需站在系统架构的角度再次斟酌需求是否超出业务边界，是否契合系统规划的方向；产品宣讲需求背景的来龙去脉，评估会给用户提升多大的价值，产出需求文档。

**系分/用例设计**：需求评审完毕后，项目迭代就成立了，开发同学须编写系分设计文档，需包含UML类图设计、时序图设计、数据库设计、接口设计（出参、入参）、伪代码、测试范围等，测试同学须编写测试用例，需覆盖能预见的所有case，每条用例都应包含步骤和期望结果。

**系分/用例评审**：评审开发同学的系分设计，在评审他人方案设计时，如果团队内其他成员有不同意见须在评审中当面提出，提出更好的设计方案让对应的开发同学修改，如其他有疑问，方案设计者须给大家解惑。**评审的目的是系分设计方案必须得到团队内成员的一致认可，让各成员所做事项更加透明，信息更加对称，团队成员之间可以互相学习，取长补短，充分发挥集体的智慧**。通过系分评审能够掌握开发同学所做事项的复杂程度，可以有效的预估出时间和风险，规避开发同学给出荒唐的开发时间，规避项目预知的风险；团队成员非常清楚他人的设计方案，可以互为主备，不至于一个萝卜一个坑的窘境；团队内有经验的同学通过评审在潜移默化中影响他人，同时也提升了团队的整体实力。测试用例评审可以从测试的角度来扩展开发同学的思维，让开发同学的代码更可靠，同时也能将异常流程提前暴露，不至于提测后bug众多，有效的保证了提测的质量和团队对项目的理解。评审完毕后，确定开发时间、测试时间和发布时间，然后进入编码阶段。

大部分团队都不愿做这件事，因为觉得写设计文档很麻烦，有写文档的时间功能都开发完了，这是我大致领会到意思，因贪图一时便捷，却忽略其带来的团队价值。

**开发阶段**：开发同学须按预定时间完成编码工作，测试用例必须覆盖80%的代码，完成测试指派的冒烟用例，保证提测的质量。

**测试阶段**：测试同学按用例设计完成两轮功能测试，及性能测试和网络异常测试，用户体验评测。此时开发同学是比较空闲的，必须组织代码评审，保证代码符合约定规范，杜绝不良设计引起的性能问题。也许有些同学会担心此时评审会影响测试进度，经过实践证明是不会影响的，因为前期做过系分评审，就保证了方案的正确性，所以不会存在大的改动，变更后的代码必须在测试用例通过后才能提交。

**Sit测试阶段**：**代码合并主分支（trunk/master分支），代码封版**。此阶段修复bug必须慎重、保证质量，以免引起修复一个bug引出几个bug的情况。此轮测试是保障线上质量的基石，须做好回归测试。

**预发布阶段**：预发布也可以理解为灰度发布，通过线上部分账号来测试新发布功能，验证功能是否发布成功。比如线上的配置是否已配，依赖服务是否上线，数据库变更是否执行等。

**体验**：产品体验和业务方验收。验收通过后上线，反之，则须要回滚或者延期，追溯上线失败的原因加以总结。

**上线**：最后是上线了，上线成功后须观察系统的指标和业务指标，是否达到预期效果，是否给用户提升了价值。

我们不难发现，项目的质量是需要通过多层测试来保障，而制约测试顺利推进的因素中，环境不稳定表现的尤为突出。譬如，测试同学在测试中反馈系统异常了，依赖第三方服务调不通或者报错了，开发同学就需要跟进排查，也许就是别人的一次正常部署，影响着整体测试进度。**制定研发环境体系是必不可少的，下面的划分的研发环境体系是跟研发流程相呼应的**。

**Dev环境**:部署开发分支（dev_xxxx分支）代码，由开发同学完成联调、自测和冒烟。进入Sit阶段生命周期结束。

**Test环境**：部署测试分支（test_xxxx分支）代码，由测试同学完成功能测试。进入Sit阶段生命周期结束。

**Sit环境**：部署本次迭代封版的主分支代码，由测试同学完成回归测试。

**Stable环境**：部署线上运行代码，用于线下复现线上问题，供依赖该系统的服务的第三方服务调用，保证线下环境的稳定。换而言之，Dev、Test、Sit环境都是依赖其他业务方的Stable环境。

**预发布环境**：预发布环境是必须的，能有效的检测出方案的兼容性，是线上环境稳定运行的最后一道关卡。

通过以上研发流程能够保障项目的循序渐进的推进，但是必须严格控制迭代的节奏。有些同学已步入误区，尤其是创业公司的同仁们，理解所谓的快速响应，就是无节操的安排发版计划，每天发布一个版本，每个需求都是紧急需求，严重消耗团队的战斗力。应该制定固定的发版日期，再规划合理的迭代计划，在迭代中拥抱变化，保障项目的循序渐进的推进。

参考文献：

《敏捷软件开发》

联系方式：

https://github.com/longtian2

**如有用请不吝打赏**

![](https://github.com/longtian2/cc3/blob/master/images/wechat_pay.png)